<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Blog</title>
  <style>
    /* Base styling */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      padding: 20px;
      transition: background-color 0.3s ease, color 0.3s ease;
      position: relative;
      min-height: 100vh;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=1200');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      opacity: 0.08;
      z-index: -1;
      transition: opacity 0.3s ease;
    }

    body.light-mode {
      background-color: #f5f1e8;
      color: #2c2416;
    }

    body.dark-mode {
      background-color: #1a1614;
      color: #e8dcc8;
    }

    body.dark-mode::before {
      opacity: 0.04;
    }

    /* Navigation bar */
    nav {
      background: linear-gradient(135deg, #8b7355 0%, #6b5444 100%);
      padding: 15px 20px;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    body.dark-mode nav {
      background: linear-gradient(135deg, #3d3128 0%, #2a2118 100%);
    }

    nav a {
      color: #fff8e7;
      text-decoration: none;
      font-weight: bold;
      font-size: 18px;
      transition: all 0.3s ease;
      padding: 8px 16px;
      border-radius: 5px;
    }

    nav a:hover {
      color: #ffd700;
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
    }

    /* Toggle Switch */
    .theme-toggle {
      position: relative;
      width: 60px;
      height: 30px;
      background: #d4a574;
      border-radius: 30px;
      cursor: pointer;
      transition: background 0.3s ease;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .theme-toggle.active {
      background: #5a4a3a;
    }

    .theme-toggle::before {
      content: '‚òÄÔ∏è';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }

    .theme-toggle.active::before {
      content: 'üåô';
      transform: translateX(30px);
    }

    /* Main heading */
    h1 {
      color: #6b5444;
      margin-bottom: 30px;
      text-align: center;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      font-family: 'Georgia', serif;
    }

    body.dark-mode h1 {
      color: #d4a574;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    /* Blog container */
    #blog-container {
      max-width: 900px;
      margin: 0 auto;
    }

    /* Blog post preview */
    .blog-post-wrapper {
      background: rgba(255, 252, 245, 0.95);
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(107, 84, 68, 0.2);
      transition: transform 0.2s ease, background 0.3s ease;
      border-left: 4px solid #8b7355;
    }

    body.dark-mode .blog-post-wrapper {
      background: rgba(42, 33, 24, 0.95);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
      border-left: 4px solid #d4a574;
    }

    .blog-post-wrapper:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(107, 84, 68, 0.4);
    }

    body.dark-mode .blog-post-wrapper:hover {
      box-shadow: 0 4px 12px rgba(212, 165, 116, 0.3);
    }

    .blog-post-link {
      text-decoration: none;
      color: inherit;
      display: block;
    }

    .blog-post-link h2 {
      color: #6b5444;
      margin-bottom: 10px;
      font-family: 'Georgia', serif;
    }

    body.dark-mode .blog-post-link h2 {
      color: #d4a574;
    }

    .blog-post-link p {
      margin: 10px 0;
    }

    /* Like/Dislike buttons */
    .reaction-buttons {
      display: flex;
      gap: 15px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #d4a574;
    }

    body.dark-mode .reaction-buttons {
      border-top: 1px solid #5a4a3a;
    }

    .reaction-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      border: 2px solid #c9a676;
      background: transparent;
      border-radius: 20px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
      color: inherit;
    }

    body.dark-mode .reaction-btn {
      border-color: #6b5444;
    }

    .reaction-btn:hover {
      transform: scale(1.05);
    }

    .reaction-btn.like-btn:hover {
      border-color: #8b7355;
      color: #6b5444;
      background: rgba(139, 115, 85, 0.1);
    }

    .reaction-btn.like-btn.active {
      background: #8b7355;
      color: white;
      border-color: #8b7355;
    }

    .reaction-btn.dislike-btn:hover {
      border-color: #a0522d;
      color: #a0522d;
      background: rgba(160, 82, 45, 0.1);
    }

    .reaction-btn.dislike-btn.active {
      background: #a0522d;
      color: white;
      border-color: #a0522d;
    }

    .reaction-count {
      font-weight: bold;
      min-width: 20px;
    }

    /* Loading indicator */
    .loading {
      text-align: center;
      padding: 20px;
      color: #8b7355;
    }

    /* Responsive design */
    @media screen and (max-width: 600px) {
      body {
        padding: 10px;
      }

      nav {
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
      }

      nav a {
        font-size: 16px;
      }

      h1 {
        font-size: 24px;
      }

      .blog-post-wrapper {
        padding: 15px;
      }
    }
  </style>
</head>
<body class="light-mode">
  <nav>
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <div class="theme-toggle" id="themeToggle"></div>
  </nav>

  <h1>My Blog Posts</h1>
  <div id="blog-container"></div>

  <script>
    // Blog data
    const blogData = [
      {
        "title": "Understanding Artificial Intelligence: The Future is Now",
        "slug": "ai-future",
        "date": "2025-06-06",
        "category": "Technology",
        "preview": "Artificial Intelligence (AI) is changing how we live and work every day. From virtual assistants to self-driving cars, AI is becoming a vital part of modern life."
      },
      {
        "title": "üáÆüá≥ Starlink's Imminent Launch in India",
        "slug": "starlink-india-launch",
        "date": "2025-06-06",
        "category": "Technology",
        "preview": "Starlink is set to launch satellite internet in India soon, promising fast, affordable access for rural areas and a major shift in digital connectivity."
      },
      {
        "title": "The Secret Societies: Illuminati & Freemasons",
        "slug": "secret-societies-illuminati-freemasons",
        "date": "2025-06-06",
        "category": "Conspiracy",
        "preview": "Dive into the mysterious world of secret societies like the Illuminati and Freemasons‚Äîexploring what's fact, what's fiction, and why they capture our imagination."
      },
      {
        "title": "The rise of the quantum computing",
        "slug": "The_rise_of_Quantum_Computing",
        "date": "2025-07-31",
        "category": "Technology",
        "preview": "Quantum computers use quantum bits, or qubits, that can exist in multiple states at once due to a phenomenon called superposition, allowing them to perform complex computations far more efficiently than classical bits"
      }
    ];

    // Theme toggle functionality
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;

    // Load saved theme
    const savedTheme = localStorage.getItem('theme') || 'light-mode';
    body.className = savedTheme;
    if (savedTheme === 'dark-mode') {
      themeToggle.classList.add('active');
    }

    themeToggle.addEventListener('click', () => {
      if (body.classList.contains('light-mode')) {
        body.classList.replace('light-mode', 'dark-mode');
        themeToggle.classList.add('active');
        localStorage.setItem('theme', 'dark-mode');
      } else {
        body.classList.replace('dark-mode', 'light-mode');
        themeToggle.classList.remove('active');
        localStorage.setItem('theme', 'light-mode');
      }
    });

    // Storage functions for persistent reactions
    async function loadGlobalReactions() {
      try {
        const result = await window.storage.get('blog-reactions', true);
        if (result && result.value) {
          return JSON.parse(result.value);
        }
        return {};
      } catch (error) {
        console.log('Loading initial reactions');
        return {};
      }
    }

    async function saveGlobalReactions(reactions) {
      try {
        await window.storage.set('blog-reactions', JSON.stringify(reactions), true);
      } catch (error) {
        console.error('Error saving reactions:', error);
      }
    }

    async function loadUserReactions() {
      try {
        const result = await window.storage.get('user-reactions', false);
        if (result && result.value) {
          return JSON.parse(result.value);
        }
        return {};
      } catch (error) {
        console.log('No previous user reactions');
        return {};
      }
    }

    async function saveUserReactions(userReactions) {
      try {
        await window.storage.set('user-reactions', JSON.stringify(userReactions), false);
      } catch (error) {
        console.error('Error saving user reactions:', error);
      }
    }

    // Initialize and render blog posts
    async function initializeBlog() {
      const container = document.getElementById('blog-container');
      container.innerHTML = '<div class="loading">Loading reactions...</div>';

      // Load global reaction counts (shared across all users)
      const globalReactions = await loadGlobalReactions();
      
      // Load user's personal reactions (which posts they liked/disliked)
      const userReactions = await loadUserReactions();

      // Initialize reactions for all posts
      blogData.forEach(post => {
        if (!globalReactions[post.slug]) {
          globalReactions[post.slug] = { likes: 0, dislikes: 0 };
        }
      });

      // Save initial state if new
      await saveGlobalReactions(globalReactions);

      // Sort and render posts
      container.innerHTML = '';
      blogData.sort((a, b) => new Date(b.date) - new Date(a.date));

      blogData.forEach(post => {
        const wrapper = document.createElement('div');
        wrapper.className = 'blog-post-wrapper';

        const postReaction = globalReactions[post.slug];
        const userReaction = userReactions[post.slug] || null;

        wrapper.innerHTML = `
          <a href="${post.slug}.html" class="blog-post-link">
            <h2>${post.title}</h2>
            <p><em>${post.date}</em> | <strong>${post.category || "General"}</strong></p>
            <p>${post.preview || "No preview available."}</p>
          </a>
          <div class="reaction-buttons">
            <button class="reaction-btn like-btn ${userReaction === 'like' ? 'active' : ''}" data-slug="${post.slug}" data-type="like">
              üëç <span class="reaction-count">${postReaction.likes}</span>
            </button>
            <button class="reaction-btn dislike-btn ${userReaction === 'dislike' ? 'active' : ''}" data-slug="${post.slug}" data-type="dislike">
              üëé <span class="reaction-count">${postReaction.dislikes}</span>
            </button>
          </div>
        `;

        container.appendChild(wrapper);
      });

      // Handle like/dislike clicks
      container.addEventListener('click', async (e) => {
        const btn = e.target.closest('.reaction-btn');
        if (!btn) return;

        e.preventDefault();
        e.stopPropagation();

        const slug = btn.dataset.slug;
        const type = btn.dataset.type;
        
        // Load current state
        const currentGlobalReactions = await loadGlobalReactions();
        const currentUserReactions = await loadUserReactions();
        
        const postReaction = currentGlobalReactions[slug];
        const previousUserReaction = currentUserReactions[slug];

        // Toggle reaction
        if (previousUserReaction === type) {
          // Remove reaction
          postReaction[type === 'like' ? 'likes' : 'dislikes']--;
          currentUserReactions[slug] = null;
          btn.classList.remove('active');
        } else {
          // Add or switch reaction
          if (previousUserReaction) {
            // Remove previous reaction count
            const prevType = previousUserReaction;
            postReaction[prevType === 'like' ? 'likes' : 'dislikes']--;
            const prevBtn = container.querySelector(`[data-slug="${slug}"][data-type="${prevType}"]`);
            prevBtn.classList.remove('active');
            prevBtn.querySelector('.reaction-count').textContent = postReaction[prevType === 'like' ? 'likes' : 'dislikes'];
          }

          // Add new reaction
          postReaction[type === 'like' ? 'likes' : 'dislikes']++;
          currentUserReactions[slug] = type;
          btn.classList.add('active');
        }

        // Update count display
        btn.querySelector('.reaction-count').textContent = postReaction[type === 'like' ? 'likes' : 'dislikes'];

        // Save both global and user reactions
        await saveGlobalReactions(currentGlobalReactions);
        await saveUserReactions(currentUserReactions);
      });
    }

    // Initialize the blog when page loads
    initializeBlog();
  </script>
</body>
</html>
